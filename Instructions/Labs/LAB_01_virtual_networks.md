---
lab:
  title: 练习：为 Web 应用程序提供网络隔离和分段
  module: Guided Project - Configure secure access to workloads with Azure virtual networking services
---

# 实验室：通过隔离和分段提供共享的服务中心虚拟网络

## 场景

你的任务是将零信任原则应用于 Azure 中的中心虚拟网络。[](https://learn.microsoft.com/security/zero-trust/azure-infrastructure-networking) IT 部门需要为分支网络中的 Web 应用程序提供网络隔离和分段。 若要为 Web 应用程序提供网络隔离和分段，你需要创建包含 IT 团队提供的地址空间的子网的 Azure 虚拟网络。 创建虚拟网络后，下一步是配置虚拟网络对等互连。 这允许虚拟网络以安全且私密的方式相互通信。

### 体系结构关系图

![显示两个对等虚拟网络的关系表。](../Media/task-1.png)

### 技能任务

- 创建虚拟网络
- 创建子网
- 配置 VNet 对等互连

## 练习说明

>**** 备注：若要完成此实验室，需要分配了参与者 RBAC 角色的 **** Azure 订阅[](https://azure.microsoft.com/free/)。
> 在此实验室中，当系统要求你为未指定的任何属性创建资源时，请使用默认值。

### 创建中心和分支虚拟网络和子网

首先创建上图中显示的虚拟网络。

1. 打开浏览器并导航到“Azure 门户”并登录<a href="https://portal.azure.com/#home"></a>。
1. 要创建虚拟网络，请在门户类型顶部的搜索框中输入“虚拟网络”，并从结果中选择“虚拟网络”。********
1. 在“虚拟网络”**** 门户窗格中选择“+ 创建****”。
1. 使用下表中的值填写创建过程的所有选项卡：

    | 属性             | 值           |
    | :------------------- | :-------------- |
    | 资源组       | RG1****         |
    | 名称                 | app-vnet****    |
    | 区域               | **美国东部**     |
    | IPv4 地址空间   | 10.1.0.0/16**** |
    | 子网名称          | 前端    |
    | 子网地址范围 | **10.1.0.0/24** |
    | 子网名称          | backend****     |
    | 子网地址范围 | **10.1.1.0/24** |

    **** 备注：将其他设置保留为默认设置。 选择“下一步”**** 转到下一个选项卡，然后选择“创建”**** 以创建虚拟网络。
1. 按照上面的相同步骤，使用下表中的值创建 Azure 虚拟网络 Hub-vnet****：

    | 属性             | 值                    |
    | :------------------- | :----------------------- |
    | 资源组       | RG1****                  |
    | 名称                 | **** Hub-vnet |
    | 区域               | **美国东部**              |
    | IPv4 地址空间   | **10.0.0.0/16**          |
    | 子网名称          | **AzureFirewallSubnet**  |
    | 子网地址范围 | **10.0.0.0/24**          |

1. 部署完成后。 导航回 Azure 门户，在搜索栏中键入“资源组”，然后从搜索结果中选择“资源组” 。******** 在主窗格中选择 “RG1”**** ，并确认两个虚拟网络均已部署。

### 设置虚拟网络之间的对等关系

1. 在两个虚拟网络之间设置对等互连关系，以允许流量在 app-vnet 和 hub-vnet 虚拟网络之间双向流动。********
1. 可以在 Azure 门户中查看 RG1 资源组。 选择“app-vnet****”虚拟网络。
1. 在门户左侧的 app-vnet**** 上下文菜单中向下滚动，并选择“对等互连”****
1. 在 app-vnet**** 对等互连窗格中选择“+ 添加****”。
1. 使用下表中的值填写表单：

    | 属性                                 | Value                          |
    | :--------------------------------------- | :----------------------------- |
    | 本虚拟网络对等互连链接名称   | **** app-vnet-to-hub |
    | 远程虚拟网络对等互连链接名称 | **** hub-to-app-vnet |
    | 虚拟网络                          | **** hub-vnet       |

    **** 备注：将其他设置保留为默认设置。 选择“添加”，创建虚拟网络对等互连****。

    [详细了解虚拟网络对等互连](https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering?tabs=peering-portal)

1. 完成该过程，且配置更新后。 验证对等互连状态是否**** 设置为“已连接”。**** （可能需要刷新页面才能启用更新的状态）
